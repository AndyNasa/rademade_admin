<% content_for :last_crumbs do %>
    <span><%=admin_list_name(@item_name)%></span>
<% end %>

<% content_for :page_header do %>
    <h3><%=admin_list_name(@item_name)%></h3>
<% end %>

<% content_for :nav_buttons do %><%
    new_uri = admin_new_uri(@model_name)
    if new_uri
        concat link_to admin_add_name(@item_name) + '+', new_uri, :class => 'btn-flat success new-product'
    end
%><% end %>

<% content_for :content do %>
    <% if @sortable_service.can_reset? %>
        <a href="<%= request.path %>">Reset sorting</a>
    <% end %>
    <table class="table table-hover">

        <thead>
            <tr>
                <% @list_fields.each_with_index do |name, index| %>
                    <th class="col-md-3 sort-button" data-column="<%= name %>">
                        <% unless index == 0 %>
                            <span class="line"></span>
                        <% end %>
                        <span><%= field_to_label(name) + @sortable_service.sorting_sign(name) %></span>
                    </th>
                <% end %>

                <th class="col-md-3 align-right">
                    <span class="line"></span>
                    <span>Management</span>
                </th>
            </tr>
        </thead>

        <% has_position = @sortable_service.has_position? %>
        <tbody class="table-sortable" data-position='<%= has_position %>'>
            <% @items.each_with_index do |item, index| %>
                <tr<%
                    if has_position
                        %> id='<%= item.position %>'<%
                    end
                %> data-id='<%= item.id %>'>
                    <% @list_fields.each do |name|
                        %><td><%
                            value = item.send(name)
                            # todo remove hard code, extract helper (data adapter)
                            if value.respond_to? :id
                                concat link_to value.to_s, admin_edit_uri(value)
                            else
                                concat value
                            end
                        %></td>
                    <% end %>
                    <td>
                        <ul class="actions">
                            <li><%= link_to 'Edit', admin_edit_uri(item) %></li>
                            <li><%= button_to 'Destroy', admin_delete_uri(item), {
                                :method => :delete,
                                :form => {:class => 'delete-item-form'}
                            } %></li>
                        </ul>
                    </td>
                </tr>
            <% end %>
        </tbody>
    </table>

    <%= render 'rademade_admin/_blocks/pagination' %>

<% end %>

<%= render :template => 'rademade_admin/_layouts/inner' %>